{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "681cb9d4",
   "metadata": {},
   "source": [
    "# 1. Extracting the data"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "51d394f6",
   "metadata": {},
   "source": [
    "### Importing essential libraries"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "33f061c5",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "pd.options.mode.chained_assignment = None\n",
    "# !pip install pycountry\n",
    "import pycountry as pc"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e84ecfea",
   "metadata": {},
   "source": [
    "### Reading the CSV"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "dec4da9c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>hs_code</th>\n",
       "      <th>shipper_name</th>\n",
       "      <th>std_unit</th>\n",
       "      <th>std_quantity</th>\n",
       "      <th>value_fob_usd</th>\n",
       "      <th>items_number</th>\n",
       "      <th>source_port</th>\n",
       "      <th>source_country</th>\n",
       "      <th>destination_port</th>\n",
       "      <th>destination_country</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>17/06/2022</td>\n",
       "      <td>87042313</td>\n",
       "      <td>jany strosin</td>\n",
       "      <td>KGS</td>\n",
       "      <td>7595</td>\n",
       "      <td>6548,21</td>\n",
       "      <td>1</td>\n",
       "      <td>ITALB</td>\n",
       "      <td>Italy</td>\n",
       "      <td>JOZAR</td>\n",
       "      <td>Jordan</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>22/06/2022</td>\n",
       "      <td>87042323</td>\n",
       "      <td>cristobal brown</td>\n",
       "      <td>KGS</td>\n",
       "      <td>7581</td>\n",
       "      <td>64880,18</td>\n",
       "      <td>1</td>\n",
       "      <td>DEASH</td>\n",
       "      <td>Germany</td>\n",
       "      <td>JOAQB</td>\n",
       "      <td>Jordan</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>06/06/2022</td>\n",
       "      <td>87042321</td>\n",
       "      <td>nick connelly</td>\n",
       "      <td>KGS</td>\n",
       "      <td>8303</td>\n",
       "      <td>71059,25</td>\n",
       "      <td>1</td>\n",
       "      <td>DEANS</td>\n",
       "      <td>Germany</td>\n",
       "      <td>AEKHA</td>\n",
       "      <td>United Arab Emirates</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>06/06/2022</td>\n",
       "      <td>87042311</td>\n",
       "      <td>alda reilly</td>\n",
       "      <td>KGS</td>\n",
       "      <td>8063</td>\n",
       "      <td>69005,27</td>\n",
       "      <td>1</td>\n",
       "      <td>ITALI</td>\n",
       "      <td>Italy</td>\n",
       "      <td>AEJYH</td>\n",
       "      <td>United Arab Emirates</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>03/06/2022</td>\n",
       "      <td>87042313</td>\n",
       "      <td>anderson crooks</td>\n",
       "      <td>KGS</td>\n",
       "      <td>8134</td>\n",
       "      <td>69612,90</td>\n",
       "      <td>1</td>\n",
       "      <td>BEANL</td>\n",
       "      <td>Belgium</td>\n",
       "      <td>AEPRA</td>\n",
       "      <td>United Arab Emirates</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         date   hs_code     shipper_name std_unit  std_quantity value_fob_usd  \\\n",
       "0  17/06/2022  87042313     jany strosin      KGS          7595       6548,21   \n",
       "1  22/06/2022  87042323  cristobal brown      KGS          7581      64880,18   \n",
       "2  06/06/2022  87042321    nick connelly      KGS          8303      71059,25   \n",
       "3  06/06/2022  87042311      alda reilly      KGS          8063      69005,27   \n",
       "4  03/06/2022  87042313  anderson crooks      KGS          8134      69612,90   \n",
       "\n",
       "  items_number source_port source_country destination_port  \\\n",
       "0            1       ITALB          Italy            JOZAR   \n",
       "1            1       DEASH        Germany            JOAQB   \n",
       "2            1       DEANS        Germany            AEKHA   \n",
       "3            1       ITALI          Italy            AEJYH   \n",
       "4            1       BEANL        Belgium            AEPRA   \n",
       "\n",
       "    destination_country  \n",
       "0                Jordan  \n",
       "1                Jordan  \n",
       "2  United Arab Emirates  \n",
       "3  United Arab Emirates  \n",
       "4  United Arab Emirates  "
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = pd.read_csv('trades.csv', sep=';')\n",
    "\n",
    "df = df.rename(columns={'destination_country,': 'destination_country'})\n",
    "\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5682f9c0",
   "metadata": {},
   "source": [
    "## Step 1: Import / Export reports\n",
    "## Data quality validation\n",
    "### Checking for NULL/NaN values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "fe709a72",
   "metadata": {},
   "outputs": [],
   "source": [
    "def null_check(df):\n",
    "    return df.isnull().sum()\n",
    "\n",
    "def findCountryAlpha2(country_name):\n",
    "    try:\n",
    "        return pc.countries.get(name=country_name).alpha_2\n",
    "    except:\n",
    "        return (\"Country not found!\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d6531344",
   "metadata": {},
   "source": [
    "# 2. Tranforming the data"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "128b4cac",
   "metadata": {},
   "source": [
    "\n",
    "### Standardizing column values and data types"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "d638ff60",
   "metadata": {},
   "outputs": [],
   "source": [
    "def column_validation(df):\n",
    "    \n",
    "    # Converting date column to datetime data type\n",
    "    \n",
    "    df['date'] = pd.to_datetime(df['date'])\n",
    "\n",
    "    # Validating if 'HS_CODE' starts with \"870423\" and length is 8 characters\n",
    "\n",
    "    df = df.loc[(df.loc[:,'hs_code'].astype(str).str.startswith('870423')) & (df.loc[:,'hs_code'].astype(str).str.len() == 8)]\n",
    "    df['hs_code'] = df['hs_code'].astype(np.int64)\n",
    "\n",
    "    df['shipper_name'] = df['shipper_name'].astype('str') \n",
    "    df['std_unit'] = df['std_unit'].astype('str')\n",
    "    df['std_quantity'] = df['std_quantity'].astype(np.int64)\n",
    "    df.loc[:,'value_fob_usd'] = df['value_fob_usd'].str.replace(',','.').astype(np.float64)\n",
    "    \n",
    "    # As mentioned, we can assume the number is 1 if the value is less than 80,000 USD when there's no information\n",
    "    \n",
    "    df.loc[df['value_fob_usd'] < 80000.00,'items_number'] = 1\n",
    "    df['items_number'] = df['items_number'].astype(np.int64)\n",
    "\n",
    "    # Check if port code starts with the country's ISO Alpha-2 code\n",
    "\n",
    "    df[[\"source_iso\",\"destination_iso\"]] = np.nan # for validation purpose\n",
    "    \n",
    "    df.loc[:,('source_iso')] = df.apply(lambda row: findCountryAlpha2(row.source_country) , axis = 1)\n",
    "    df.loc[:,('destination_iso')] = df.apply(lambda row: findCountryAlpha2(row.destination_country) , axis = 1)\n",
    "\n",
    "\n",
    "    df['source_check'] = [y.startswith(x) for x,y in zip(df['source_iso'], df['source_port'])]\n",
    "    df['destination_check'] = [y.startswith(x) for x,y in zip(df['destination_iso'], df['destination_port'])]\n",
    "    \n",
    "    return df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "1201c426",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Count of NULL/Nan values in each column:\n",
      "date                   0\n",
      "hs_code                0\n",
      "shipper_name           0\n",
      "std_unit               0\n",
      "std_quantity           0\n",
      "value_fob_usd          0\n",
      "items_number           0\n",
      "source_port            0\n",
      "source_country         0\n",
      "destination_port       0\n",
      "destination_country    0\n",
      "dtype: int64\n"
     ]
    }
   ],
   "source": [
    "print(\"Count of NULL/Nan values in each column:\")\n",
    "print(null_check(df))\n",
    "df = column_validation(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "05e1733a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>hs_code</th>\n",
       "      <th>shipper_name</th>\n",
       "      <th>std_unit</th>\n",
       "      <th>std_quantity</th>\n",
       "      <th>value_fob_usd</th>\n",
       "      <th>items_number</th>\n",
       "      <th>source_port</th>\n",
       "      <th>source_country</th>\n",
       "      <th>destination_port</th>\n",
       "      <th>destination_country</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2022-06-17</td>\n",
       "      <td>87042313</td>\n",
       "      <td>jany strosin</td>\n",
       "      <td>KGS</td>\n",
       "      <td>7595</td>\n",
       "      <td>6548.21</td>\n",
       "      <td>1</td>\n",
       "      <td>ITALB</td>\n",
       "      <td>Italy</td>\n",
       "      <td>JOZAR</td>\n",
       "      <td>Jordan</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2022-06-22</td>\n",
       "      <td>87042323</td>\n",
       "      <td>cristobal brown</td>\n",
       "      <td>KGS</td>\n",
       "      <td>7581</td>\n",
       "      <td>64880.18</td>\n",
       "      <td>1</td>\n",
       "      <td>DEASH</td>\n",
       "      <td>Germany</td>\n",
       "      <td>JOAQB</td>\n",
       "      <td>Jordan</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2022-06-06</td>\n",
       "      <td>87042321</td>\n",
       "      <td>nick connelly</td>\n",
       "      <td>KGS</td>\n",
       "      <td>8303</td>\n",
       "      <td>71059.25</td>\n",
       "      <td>1</td>\n",
       "      <td>DEANS</td>\n",
       "      <td>Germany</td>\n",
       "      <td>AEKHA</td>\n",
       "      <td>United Arab Emirates</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2022-06-06</td>\n",
       "      <td>87042311</td>\n",
       "      <td>alda reilly</td>\n",
       "      <td>KGS</td>\n",
       "      <td>8063</td>\n",
       "      <td>69005.27</td>\n",
       "      <td>1</td>\n",
       "      <td>ITALI</td>\n",
       "      <td>Italy</td>\n",
       "      <td>AEJYH</td>\n",
       "      <td>United Arab Emirates</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2022-03-06</td>\n",
       "      <td>87042313</td>\n",
       "      <td>anderson crooks</td>\n",
       "      <td>KGS</td>\n",
       "      <td>8134</td>\n",
       "      <td>69612.90</td>\n",
       "      <td>1</td>\n",
       "      <td>BEANL</td>\n",
       "      <td>Belgium</td>\n",
       "      <td>AEPRA</td>\n",
       "      <td>United Arab Emirates</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>507</th>\n",
       "      <td>2022-06-27</td>\n",
       "      <td>87042313</td>\n",
       "      <td>carmine schmitt</td>\n",
       "      <td>KGS</td>\n",
       "      <td>8263</td>\n",
       "      <td>70716.92</td>\n",
       "      <td>1</td>\n",
       "      <td>ITARS</td>\n",
       "      <td>Italy</td>\n",
       "      <td>JOZAR</td>\n",
       "      <td>Jordan</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>508</th>\n",
       "      <td>2022-06-16</td>\n",
       "      <td>87042322</td>\n",
       "      <td>winfield gislason</td>\n",
       "      <td>KGS</td>\n",
       "      <td>7574</td>\n",
       "      <td>64820.28</td>\n",
       "      <td>1</td>\n",
       "      <td>DEASC</td>\n",
       "      <td>Germany</td>\n",
       "      <td>JOAQJ</td>\n",
       "      <td>Jordan</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>509</th>\n",
       "      <td>2022-12-06</td>\n",
       "      <td>87042321</td>\n",
       "      <td>cyrus larson</td>\n",
       "      <td>KGS</td>\n",
       "      <td>7853</td>\n",
       "      <td>67208.03</td>\n",
       "      <td>1</td>\n",
       "      <td>DEARG</td>\n",
       "      <td>Germany</td>\n",
       "      <td>AEDBP</td>\n",
       "      <td>United Arab Emirates</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>510</th>\n",
       "      <td>2022-06-22</td>\n",
       "      <td>87042313</td>\n",
       "      <td>oliver waters</td>\n",
       "      <td>KGS</td>\n",
       "      <td>7695</td>\n",
       "      <td>65855.83</td>\n",
       "      <td>1</td>\n",
       "      <td>ITASM</td>\n",
       "      <td>Italy</td>\n",
       "      <td>AEIND</td>\n",
       "      <td>United Arab Emirates</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>511</th>\n",
       "      <td>2022-06-20</td>\n",
       "      <td>87042313</td>\n",
       "      <td>emmitt kuhic</td>\n",
       "      <td>KGS</td>\n",
       "      <td>8358</td>\n",
       "      <td>71529.95</td>\n",
       "      <td>1</td>\n",
       "      <td>ITAVO</td>\n",
       "      <td>Italy</td>\n",
       "      <td>JOAQJ</td>\n",
       "      <td>Jordan</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>506 rows × 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          date   hs_code       shipper_name std_unit  std_quantity  \\\n",
       "0   2022-06-17  87042313       jany strosin      KGS          7595   \n",
       "1   2022-06-22  87042323    cristobal brown      KGS          7581   \n",
       "2   2022-06-06  87042321      nick connelly      KGS          8303   \n",
       "3   2022-06-06  87042311        alda reilly      KGS          8063   \n",
       "4   2022-03-06  87042313    anderson crooks      KGS          8134   \n",
       "..         ...       ...                ...      ...           ...   \n",
       "507 2022-06-27  87042313    carmine schmitt      KGS          8263   \n",
       "508 2022-06-16  87042322  winfield gislason      KGS          7574   \n",
       "509 2022-12-06  87042321       cyrus larson      KGS          7853   \n",
       "510 2022-06-22  87042313      oliver waters      KGS          7695   \n",
       "511 2022-06-20  87042313       emmitt kuhic      KGS          8358   \n",
       "\n",
       "     value_fob_usd  items_number source_port source_country destination_port  \\\n",
       "0          6548.21             1       ITALB          Italy            JOZAR   \n",
       "1         64880.18             1       DEASH        Germany            JOAQB   \n",
       "2         71059.25             1       DEANS        Germany            AEKHA   \n",
       "3         69005.27             1       ITALI          Italy            AEJYH   \n",
       "4         69612.90             1       BEANL        Belgium            AEPRA   \n",
       "..             ...           ...         ...            ...              ...   \n",
       "507       70716.92             1       ITARS          Italy            JOZAR   \n",
       "508       64820.28             1       DEASC        Germany            JOAQJ   \n",
       "509       67208.03             1       DEARG        Germany            AEDBP   \n",
       "510       65855.83             1       ITASM          Italy            AEIND   \n",
       "511       71529.95             1       ITAVO          Italy            JOAQJ   \n",
       "\n",
       "      destination_country  \n",
       "0                  Jordan  \n",
       "1                  Jordan  \n",
       "2    United Arab Emirates  \n",
       "3    United Arab Emirates  \n",
       "4    United Arab Emirates  \n",
       "..                    ...  \n",
       "507                Jordan  \n",
       "508                Jordan  \n",
       "509  United Arab Emirates  \n",
       "510  United Arab Emirates  \n",
       "511                Jordan  \n",
       "\n",
       "[506 rows x 11 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_final = df.iloc[:, :-4]\n",
    "df_final"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2463b541",
   "metadata": {},
   "source": [
    "## Goal 1\n",
    "### Popular shipping countries and routes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "2efe2efe",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Most popular shipping countries:\n",
      " source_country  destination_country \n",
      "Italy           Jordan                  96\n",
      "Belgium         United Arab Emirates    95\n",
      "Italy           United Arab Emirates    84\n",
      "Belgium         Jordan                  83\n",
      "Germany         Jordan                  77\n",
      "                United Arab Emirates    71\n",
      "Name: source_country, dtype: int64\n",
      "\n",
      "\n",
      "\n",
      "Most popular shipping routes:\n",
      " source_port  destination_port\n",
      "BEABO        JOZAR               3\n",
      "DEALN        JOAQJ               3\n",
      "ITACC        JOAQB               2\n",
      "ITANN        JOMPQ               2\n",
      "ITASP        JOAMM               2\n",
      "                                ..\n",
      "BEBDH        JOAQB               1\n",
      "             AERUW               1\n",
      "BEBDE        JOMPQ               1\n",
      "BEBCT        AEMAS               1\n",
      "ITAZZ        JOAQB               1\n",
      "Name: source_port, Length: 486, dtype: int64\n"
     ]
    }
   ],
   "source": [
    "df_1 = df_final.groupby(['source_country','destination_country'])['source_country'].count()\n",
    "print(\"Most popular shipping countries:\\n\", df_1.sort_values(ascending = False))\n",
    "\n",
    "\n",
    "df_2 = df_final.groupby(['source_port','destination_port'])['source_port'].count()\n",
    "print(\"\\n\\n\\nMost popular shipping routes:\\n\", df_2.sort_values(ascending = False))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dcb6ee66",
   "metadata": {},
   "source": [
    "### Average import value (in USD) per country"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "3a036e4f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Average import value per country:\n",
      " destination_country\n",
      "United Arab Emirates    68691.520760\n",
      "Jordan                  68304.864258\n",
      "Name: value_fob_usd, dtype: float64\n"
     ]
    }
   ],
   "source": [
    "df2 = df_final.groupby(['destination_country'])['value_fob_usd'].mean()\n",
    "\n",
    "print(\"Average import value per country:\\n\",df2.sort_values(ascending = False))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1c31fb35",
   "metadata": {},
   "source": [
    "# Step 2 (Web-scraping using BeautifulSoup and requests libraries)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "9b236b3b",
   "metadata": {},
   "outputs": [],
   "source": [
    "countries = set(df['source_iso']) | set(df['destination_iso'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "afa0163c",
   "metadata": {},
   "outputs": [],
   "source": [
    "from bs4 import BeautifulSoup\n",
    "import requests\n",
    "\n",
    "main_url = \"https://www.cogoport.com\"\n",
    "seaport_page = '/en-IN/knowledge-center/resources/port-info'\n",
    "results = requests.get(main_url+seaport_page).text\n",
    "soup = BeautifulSoup(results, \"html.parser\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "62525a99",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Antwerp (BEANR)\n",
      "{'safmarine', 'Hapag', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " There are no unique country requirements or restrictions for this port.You can reach out to us directly in case of any further queries.\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " Prohibited\n",
      "\n",
      "• Meat and milk and any items thereof from non-EU countries with the exception of limited amounts from Andorra, Croatia, the Faeroe Islands, Greenland, Iceland and some specific products from other countries\n",
      "• Protected species and products thereof as listed by the CITES (Washington Convention) for example ivory, tortoise shell, coral, reptile skin and wood from Amazonian forests.\n",
      "\n",
      "Restricted\n",
      "\n",
      "• pets need to be identifiable (tattoo or an electronic identification system), vaccinated against rabies and have a health certificate. For more information you can refer to the nearest embassy.\n",
      "• maximum of 10 kg of meat, milk and dairy products coming from Croatia, Færøer Islands, Greenland and Iceland\n",
      "• powdered milk for babies, food for children and special medical food (including pet food) may be allowed if they do not require refrigeration prior to opening. Or if it is branded packaged food and the packaging has a original seal (unless in use at the time). Its quantity must not exceed the weight of 10 kg originating from Croatia, Færøer Islands, Greenland and Iceland, or 2 kg if it  is originating in other countries.\n",
      "• fish only if they are disembowelled and does not exceed the weight of 20 kg,\n",
      "• currency - no restrictions if it is coming from a EU country. It is declarable for all travelling outside EU when the amount exceeds 10.000 euro or its equivalent in another currency.\n",
      "• coats, fur and leather shoes made of protected animals need special authorization\n",
      "--------------------------------------------------------------------\n",
      "Mannheim (DEMHG)\n",
      "{'safmarine', 'Hapag', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " Exporters are required to fill out a DEB (declaration of exchange of goods) or an Intrastate Declaration for all goods from within the European Community that enter Germany at the end of the month.\n",
      "\n",
      "Operators are required to fill out an Entry Summary Declaration (ENS) to the customs of the country of entry, prior to the introduction of goods into the customs territory of the European Union.\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " \n",
      "The import of unauthorised fireworks into Germany is prohibited under the provisions of the Explosives Act, and is therefore punishable.\n",
      "\n",
      "Textiles\n",
      "The import into Germany of certain textiles bought in a non-EU state may depend on your being able to show an import authorisation which you should have requested from the competent authorities before you began your journey.\n",
      "\n",
      "Animals and plants, products containing animal or vegetable substances\n",
      "In order to protect the flora and fauna when importing animals and plants, in addition to species protection requirements, animal welfare and phytosanitary aspects must also be observed.\n",
      "\n",
      "Weapons and ammunition\n",
      "The movement or import of weapons and ammunition from a non-EU state into Germany is subject the certain obligations to obtain authorisation.\n",
      "--------------------------------------------------------------------\n",
      "Hamburg (DEHAM)\n",
      "{'safmarine', 'Hapag', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " Commodity No restrictions\n",
      "Weight limits for road limits max. 40 tons including truck and chassis\n",
      "Special cargo OOG, BB and IMO cargo is subject to Safmarine-house approval procedure\n",
      "Special Customs requirement, the export customs procedure in Germany requires a customs reference, which has to be requested with local customs authorities at cost of Euro18 (Euro 43 for Dangerous Cargo) per container in the case that Maersk Logistics is performing this service.\n",
      "B/l clausing No specific clausing required\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " \n",
      "The import of unauthorised fireworks into Germany is prohibited under the provisions of the Explosives Act, and is therefore punishable.\n",
      "\n",
      "Textiles\n",
      "The import into Germany of certain textiles bought in a non-EU state may depend on your being able to show an import authorisation which you should have requested from the competent authorities before you began your journey.\n",
      "\n",
      "Animals and plants, products containing animal or vegetable substances\n",
      "In order to protect the flora and fauna when importing animals and plants, in addition to species protection requirements, animal welfare and phytosanitary aspects must also be observed.\n",
      "\n",
      "Weapons and ammunition\n",
      "The movement or import of weapons and ammunition from a non-EU state into Germany is subject the certain obligations to obtain authorisation.\n",
      "--------------------------------------------------------------------\n",
      "Bremerhaven (DEBRV)\n",
      "{'maersk', 'cosco', 'safmarine', 'Hapag', 'CMA'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " Commodity : No restrictions\n",
      "Weight limits for road limits max. 40 tons including truck and chassis\n",
      "Special cargo OOG, BB and IMO cargo is subject to regular approval procedure from the line.\n",
      "Special Customs requirement, the export customs procedure in Germany requires a customs reference, which has to be requested with local customs authorities at cost of Euro18 (Euro 43 for Dangerous Cargo) per container in the case that Maersk Logistics is performing this service.\n",
      "B/l clausing No specific clausing required\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " \n",
      "The import of unauthorised fireworks into Germany is prohibited under the provisions of the Explosives Act, and is therefore punishable.\n",
      "\n",
      "Textiles\n",
      "The import into Germany of certain textiles bought in a non-EU state may depend on your being able to show an import authorisation which you should have requested from the competent authorities before you began your journey.\n",
      "\n",
      "Animals and plants, products containing animal or vegetable substances\n",
      "In order to protect the flora and fauna when importing animals and plants, in addition to species protection requirements, animal welfare and phytosanitary aspects must also be observed.\n",
      "\n",
      "Weapons and ammunition\n",
      "The movement or import of weapons and ammunition from a non-EU state into Germany is subject the certain obligations to obtain authorisation.\n",
      "--------------------------------------------------------------------\n",
      "Bremen (DEBRE)\n",
      "{'maersk', 'cosco', 'safmarine', 'Hapag', 'CMA'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " Commodity No restrictions\n",
      "Weight limits for road limits max. 40 tons including truck and chassis\n",
      "Special cargo OOG, BB and IMO cargo is subject to Safmarine-house approval procedure\n",
      "Special Customs requirement, the export customs procedure in Germany requires a customs reference, which has to be requested with local customs authorities at cost of Euro18 (Euro 43 for Dangerous Cargo) per container in the case that Maersk Logistics is performing this service.\n",
      "B/l clausing No specific clausing required\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " \n",
      "The import of unauthorised fireworks into Germany is prohibited under the provisions of the Explosives Act, and is therefore punishable.\n",
      "\n",
      "Textiles\n",
      "The import into Germany of certain textiles bought in a non-EU state may depend on your being able to show an import authorisation which you should have requested from the competent authorities before you began your journey.\n",
      "\n",
      "Animals and plants, products containing animal or vegetable substances\n",
      "In order to protect the flora and fauna when importing animals and plants, in addition to species protection requirements, animal welfare and phytosanitary aspects must also be observed.\n",
      "\n",
      "Weapons and ammunition\n",
      "The movement or import of weapons and ammunition from a non-EU state into Germany is subject the certain obligations to obtain authorisation.\n",
      "--------------------------------------------------------------------\n",
      "Amman\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'safmarine', 'Hapag', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " For changing Weight - \n",
      "1. Amendment request letter should be submitted by authorized party, mentioning: a) the exact change (From/To). b) Maersk indemnity of any chargers/delays that may occur as a result of this request and requester to take full liability.\n",
      "2. Maersk Origin office confirmation email with shipper.\n",
      "3. Original packing list with the correct weight.\n",
      "4. Original commercial invoice with the correct weight.\n",
      "5. Old delivery order if issued.\n",
      "6. 3 Original Bill of Ladings or release.\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " There are no unique Country Requirements / Restrictions for this port.You can always reach out to us directly in case of any further queries.\n",
      "--------------------------------------------------------------------\n",
      "Aqaba (JOAQJ)\n",
      "{'safmarine', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " Process for changing weight - \n",
      "1. Amendment request letter should be submitted by authorized party, mentioning: a) the exact change (From/To). b) Maersk indemnity of any chargers/delays that may occur as a result of this request and the requester is to take full liability.\n",
      "2. Maersk Origin office confirmation email with shipper must be provided.\n",
      "3. Original packing list with the correct weight.\n",
      "4. Original commercial invoice with the correct weight.\n",
      "5. Old delivery order if issued.\n",
      "6. 3 Original Bill of Landings or release.\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " There are no unique country requirements or restrictions for this port.You can reach out to us directly in case of any further queries.\n",
      "--------------------------------------------------------------------\n",
      "Hulaylah\n",
      "{'safmarine', 'maersk', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " Any cargo rejected by local authorities (customs, port, health, municipality) and in case of re-export to UAE, prior approval need to be taken from destination office by providing local consignee details for acceptance of booking or loading\"\n",
      "\n",
      "Necessary Approval must be obtained from the Competent Authorities of UAE (Ministry of Environment and Water, Customs etc., ) prior to the export/ import and transit of banned waste material and Advance notification must be submitted to all relevant authorities\n",
      "\n",
      "Commodity – Charcoal/ Bitumen  not accepted for export\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " The consignee/agent should obtain a delivery order from the Shipping Agent and submit original standard trade documentation as per the following:\n",
      "Commercial invoice from the exporter addressed to the importer with details about quantity, goods description and total value of each imported item\n",
      "Certificate of origin, stating the country of origin and approved by the Chamber of Commerce in the country of origin\n",
      "Detailed packing list including weight, method of packing, and HS code for each item\n",
      "Import permit from the competent agencies in case of importing restricted goods or duty exempted goods\n",
      "Bill of entry or airway bill\n",
      "--------------------------------------------------------------------\n",
      "Khalifa\n",
      "{'safmarine', 'maersk', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " Any cargo rejected by local authorities (customs, port, health, municipality) and in case of re-export to UAE, prior approval need to be taken from destination office by providing local consignee details for acceptance of booking or loading\"\n",
      "\n",
      "Necessary Approval must be obtained from the Competent Authorities of UAE (Ministry of Environment and Water, Customs etc., ) prior to the export/ import and transit of banned waste material and Advance notification must be submitted to all relevant authorities\n",
      "\n",
      "Commodity – Charcoal/ Bitumen  not accepted for export\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " The consignee/agent should obtain a delivery order from the Shipping Agent and submit original standard trade documentation as per the following:\n",
      "Commercial invoice from the exporter addressed to the importer with details about quantity, goods description and total value of each imported item\n",
      "Certificate of origin, stating the country of origin and approved by the Chamber of Commerce in the country of origin\n",
      "Detailed packing list including weight, method of packing, and HS code for each item\n",
      "Import permit from the competent agencies in case of importing restricted goods or duty exempted goods\n",
      "Bill of entry or airway bill\n",
      "--------------------------------------------------------------------\n",
      "Ruwais\n",
      "{'safmarine', 'maersk', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " Any cargo rejected by local authorities (customs, port, health, municipality) and in case of re-export to UAE, prior approval need to be taken from destination office by providing local consignee details for acceptance of booking or loading\"\n",
      "\n",
      "Necessary Approval must be obtained from the Competent Authorities of UAE (Ministry of Environment and Water, Customs etc., ) prior to the export/ import and transit of banned waste material and Advance notification must be submitted to all relevant authorities\n",
      "\n",
      "Commodity – Charcoal/ Bitumen  not accepted for export\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " The consignee/agent should obtain a delivery order from the Shipping Agent and submit original standard trade documentation as per the following:\n",
      "Commercial invoice from the exporter addressed to the importer with details about quantity, goods description and total value of each imported item\n",
      "Certificate of origin, stating the country of origin and approved by the Chamber of Commerce in the country of origin\n",
      "Detailed packing list including weight, method of packing, and HS code for each item\n",
      "Import permit from the competent agencies in case of importing restricted goods or duty exempted goods\n",
      "Bill of entry or airway bill\n",
      "--------------------------------------------------------------------\n",
      "Fujairah (AEFJR)\n",
      "{'safmarine', 'maersk', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " Any cargo rejected by local authorities (customs, port, health, municipality) and in case of re-export to UAE, prior approval need to be taken from destination office by providing local consignee details for acceptance of booking or loading\"\n",
      "\n",
      "Necessary Approval must be obtained from the Competent Authorities of UAE (Ministry of Environment and Water, Customs etc., ) prior to the export/ import and transit of banned waste material and Advance notification must be submitted to all relevant authorities\n",
      "\n",
      "Commodity – Charcoal/ Bitumen  not accepted for export\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " The consignee/agent should obtain a delivery order from the Shipping Agent and submit original standard trade documentation as per the following:\n",
      "Commercial invoice from the exporter addressed to the importer with details about quantity, goods description and total value of each imported item\n",
      "Certificate of origin, stating the country of origin and approved by the Chamber of Commerce in the country of origin\n",
      "Detailed packing list including weight, method of packing, and HS code for each item\n",
      "Import permit from the competent agencies in case of importing restricted goods or duty exempted goods\n",
      "Bill of entry or airway bill\n",
      "--------------------------------------------------------------------\n",
      "Ajman\n",
      "{'safmarine', 'maersk', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " Any cargo rejected by local authorities (customs, port, health, municipality) and in case of re-export to UAE, prior approval need to be taken from destination office by providing local consignee details for acceptance of booking or loading\"\n",
      "\n",
      "Necessary Approval must be obtained from the Competent Authorities of UAE (Ministry of Environment and Water, Customs etc., ) prior to the export/ import and transit of banned waste material and Advance notification must be submitted to all relevant authorities\n",
      "\n",
      "Commodity – Charcoal/ Bitumen  not accepted for export\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " The consignee/agent should obtain a delivery order from the Shipping Agent and submit original standard trade documentation as per the following:\n",
      "Commercial invoice from the exporter addressed to the importer with details about quantity, goods description and total value of each imported item\n",
      "Certificate of origin, stating the country of origin and approved by the Chamber of Commerce in the country of origin\n",
      "Detailed packing list including weight, method of packing, and HS code for each item\n",
      "Import permit from the competent agencies in case of importing restricted goods or duty exempted goods\n",
      "Bill of entry or airway bill\n",
      "--------------------------------------------------------------------\n",
      "Sharjah (KHALID) (AESHJ)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'safmarine', 'maersk', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " Any cargo rejected by local authorities (customs, port, health, municipality) and in case of re-export to UAE, prior approval need to be taken from destination office by providing local consignee details for acceptance of booking or loading\"\n",
      "\n",
      "Necessary Approval must be obtained from the Competent Authorities of UAE (Ministry of Environment and Water, Customs etc., ) prior to the export/ import and transit of banned waste material and Advance notification must be submitted to all relevant authorities\n",
      "\n",
      "Commodity – Charcoal/ Bitumen  not accepted for export\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " The consignee/agent should obtain a delivery order from the Shipping Agent and submit original standard trade documentation as per the following:\n",
      "Commercial invoice from the exporter addressed to the importer with details about quantity, goods description and total value of each imported item\n",
      "Certificate of origin, stating the country of origin and approved by the Chamber of Commerce in the country of origin\n",
      "Detailed packing list including weight, method of packing, and HS code for each item\n",
      "Import permit from the competent agencies in case of importing restricted goods or duty exempted goods\n",
      "Bill of entry or airway bill\n",
      "--------------------------------------------------------------------\n",
      "Khor Fakkan (AEKLF)\n",
      "{'safmarine', 'maersk', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " Any cargo rejected by local authorities (customs, port, health, municipality) and in case of re-export to UAE, prior approval need to be taken from destination office by providing local consignee details for acceptance of booking or loading\"\n",
      "\n",
      "Necessary Approval must be obtained from the Competent Authorities of UAE (Ministry of Environment and Water, Customs etc., ) prior to the export/ import and transit of banned waste material and Advance notification must be submitted to all relevant authorities\n",
      "\n",
      "Commodity – Charcoal/ Bitumen  not accepted for export\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " \"The consignee/agent should obtain a delivery order from the Shipping Agent and submit original standard trade documentation as per the following:\n",
      "Commercial invoice from the exporter addressed to the importer with details about quantity, goods description and total value of each imported item\n",
      "Certificate of origin, stating the country of origin and approved by the Chamber of Commerce in the country of origin\n",
      "Detailed packing list including weight, method of packing, and HS code for each item\n",
      "Import permit from the competent agencies in case of importing restricted goods or duty exempted goods\n",
      "Bill of entry or airway bill\"\n",
      "--------------------------------------------------------------------\n",
      "Jebel Ali (AEJEA)\n",
      "{'safmarine', 'maersk', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " Any cargo rejected by local authorities (customs, port, health, municipality) and in case of re-export to UAE, prior approval need to be taken from destination office by providing local consignee details for acceptance of booking or loading\"\n",
      "\n",
      "Necessary Approval must be obtained from the Competent Authorities of UAE (Ministry of Environment and Water, Customs etc., ) prior to the export/ import and transit of banned waste material and Advance notification must be submitted to all relevant authorities\n",
      "\n",
      "Commodity – Charcoal/ Bitumen  not accepted for export\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " The consignee/agent should obtain a delivery order from the Shipping Agent and submit original standard trade documentation as per the following:\n",
      "Commercial invoice from the exporter addressed to the importer with details about quantity, goods description and total value of each imported item\n",
      "Certificate of origin, stating the country of origin and approved by the Chamber of Commerce in the country of origin\n",
      "Detailed packing list including weight, method of packing, and HS code for each item\n",
      "Import permit from the competent agencies in case of importing restricted goods or duty exempted goods\n",
      "Bill of entry or airway bill\n",
      "--------------------------------------------------------------------\n",
      "Abu Dhabi\n",
      "{'maersk', 'cosco', 'safmarine', 'Hapag', 'CMA'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " In case any cargo is rejected by local authorities (customs, port, health, municipality) or in case of re-export to UAE, prior approval needs to be taken from the destination office by providing local consignee details for final acceptance of booking or loading\n",
      "\n",
      "Necessary approval must be obtained from competent authorities of the UAE (Ministry of Environment and Water, Customs etc., ) prior to the export/ import or transit of banned waste material. Advance notifications must be submitted to all relevant authorities.\n",
      "\n",
      "Commodities like charcoal or bitumen are not accepted for export from this port.\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " The consignee/agent must obtain a delivery order from the Shipping Agent and submit original standard trade documentation as mentioned below:\n",
      "\n",
      "A commercial invoice from the exporter addressed to the importer with details about the quantity, goods description and the total value of each imported item\n",
      "A certificate of origin, stating the country of origin and approved by the Chamber of Commerce in the country of origin\n",
      "\n",
      "A detailed packing list including weight, method of packing, and HS code for each item\n",
      "\n",
      "An import permit from the competent agencies in case of import of restricted goods or duty exempted goods\n",
      "\n",
      "A bill of entry or airway bill\n",
      "--------------------------------------------------------------------\n",
      "Venice (Venezia) (ITVCE)\n",
      "{'safmarine', 'Hapag', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " There are no unique Country Requirements / Restrictions for this port.You can always reach out to us directly in case of any further queries.\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " Prohibited\n",
      "\n",
      "• Meat and milk and any items thereof from non-EU countries with the exception of limited amounts from Andorra, Croatia, the Faeroe Islands, Greenland, Iceland and small amounts of specific products from other countries\n",
      "• Protected species and products thereof as listed by the CITES (Washington Convention) for example ivory, tortoise shell, coral, reptile skin, wood from Amazonian forests.\n",
      "\n",
      "\"Restricted\n",
      "\n",
      "• pets need to be identifiable (tattoo or an electronic identification system), vaccinated against rabies and have a health certificate. For more information please refer to the nearest embassy.\n",
      "• maximum of 10 kg of meat, milk and dairy products coming from Croatia, Færøer Islands, Greenland and Iceland\n",
      "• powdered milk for babies, food for children and special medical food (including pets food) may be allowed if they need not to be refrigerated prior opening and that it is brand packaged food and the packaging has original seal (unless in use at the time) and its quantity must not exceed the weight of 10 kg originating from Croatia, Færøer Islands, Greenland and Iceland, and of 2 kg if originating in other countries.\n",
      "• fish only if it is disembowelled and does not exceed the weight of 20 kg,\n",
      "• currency - no restrictions if coming from EU country. Declarable for all travelling outside EU when the amount exceeds 10.000 euro or equivalent in another currency.\n",
      "• coats, fur and leather shoes made of protected animals will need special authorization\"\n",
      "--------------------------------------------------------------------\n",
      "Trieste (ITTRS)\n",
      "{'safmarine', 'Hapag', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " There are no unique Country Requirements / Restrictions for this port.You can always reach out to us directly in case of any further queries.\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " Prohibited\n",
      "\n",
      "• Meat and milk and any items thereof from non-EU countries with the exception of limited amounts from Andorra, Croatia, the Faeroe Islands, Greenland, Iceland and small amounts of specific products from other countries\n",
      "• Protected species and products thereof as listed by the CITES (Washington Convention) for example ivory, tortoise shell, coral, reptile skin, wood from Amazonian forests.\n",
      "\n",
      "\"Restricted\n",
      "\n",
      "• pets need to be identifiable (tattoo or an electronic identification system), vaccinated against rabies and have a health certificate. For more information please refer to the nearest embassy.\n",
      "• maximum of 10 kg of meat, milk and dairy products coming from Croatia, Færøer Islands, Greenland and Iceland\n",
      "• powdered milk for babies, food for children and special medical food (including pets food) may be allowed if they need not to be refrigerated prior opening and that it is brand packaged food and the packaging has original seal (unless in use at the time) and its quantity must not exceed the weight of 10 kg originating from Croatia, Færøer Islands, Greenland and Iceland, and of 2 kg if originating in other countries.\n",
      "• fish only if it is disembowelled and does not exceed the weight of 20 kg,\n",
      "• currency - no restrictions if coming from EU country. Declarable for all travelling outside EU when the amount exceeds 10.000 euro or equivalent in another currency.\n",
      "• coats, fur and leather shoes made of protected animals will need special authorization\"\n",
      "--------------------------------------------------------------------\n",
      "Salerno (ITSAL)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'safmarine', 'Hapag', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " There are no unique Country Requirements / Restrictions for this port.You can always reach out to us directly in case of any further queries.\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " Prohibited\n",
      "\n",
      "• Meat and milk and any items thereof from non-EU countries with the exception of limited amounts from Andorra, Croatia, the Faeroe Islands, Greenland, Iceland and small amounts of specific products from other countries\n",
      "• Protected species and products thereof as listed by the CITES (Washington Convention) for example ivory, tortoise shell, coral, reptile skin, wood from Amazonian forests.\n",
      "\n",
      "\"Restricted\n",
      "\n",
      "• pets need to be identifiable (tattoo or an electronic identification system), vaccinated against rabies and have a health certificate. For more information please refer to the nearest embassy.\n",
      "• maximum of 10 kg of meat, milk and dairy products coming from Croatia, Færøer Islands, Greenland and Iceland\n",
      "• powdered milk for babies, food for children and special medical food (including pets food) may be allowed if they need not to be refrigerated prior opening and that it is brand packaged food and the packaging has original seal (unless in use at the time) and its quantity must not exceed the weight of 10 kg originating from Croatia, Færøer Islands, Greenland and Iceland, and of 2 kg if originating in other countries.\n",
      "• fish only if it is disembowelled and does not exceed the weight of 20 kg,\n",
      "• currency - no restrictions if coming from EU country. Declarable for all travelling outside EU when the amount exceeds 10.000 euro or equivalent in another currency.\n",
      "• coats, fur and leather shoes made of protected animals will need special authorization\"\n",
      "--------------------------------------------------------------------\n",
      "Napoli\n",
      "{'safmarine', 'Hapag', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " There are no unique Country Requirements / Restrictions for this port.You can always reach out to us directly in case of any further queries.\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " Material can enter temporarily without customs fees if it will be used to manufacture products for export. In this case, the importer gives a guarantee (from an insurance company or bank) for the amount of duties and taxes. This guarantee will be reimbursed when the final product is exported. This process also applies to goods planned to be re-exported.\n",
      "\n",
      "Prohibited\n",
      "\n",
      "• Meat and milk and any items thereof from non-EU countries with the exception of limited amounts from Andorra, Croatia, the Faeroe Islands, Greenland, Iceland and small amounts of specific products from other countries\n",
      "• Protected species and products thereof as listed by the CITES (Washington Convention) for example ivory, tortoise shell, coral, reptile skin, wood from Amazonian forests.\n",
      "\n",
      "\n",
      "Restricted\n",
      "\n",
      "• pets need to be identifiable (tattoo or an electronic identification system), vaccinated against rabies and have a health certificate. For more information please refer to the nearest embassy.\n",
      "• maximum of 10 kg of meat, milk and dairy products coming from Croatia, Færøer Islands, Greenland and Iceland\n",
      "• powdered milk for babies, food for children and special medical food (including pets food) may be allowed if they need not to be refrigerated prior opening and that it is brand packaged food and the packaging has original seal (unless in use at the time) and its quantity must not exceed the weight of 10 kg originating from Croatia, Færøer Islands, Greenland and Iceland, and of 2 kg if originating in other countries.\n",
      "• fish only if it is disembowelled and does not exceed the weight of 20 kg,\n",
      "• currency - no restrictions if coming from EU country. Declarable for all travelling outside EU when the amount exceeds 10.000 euro or equivalent in another currency.\n",
      "• coats, fur and leather shoes made of protected animals will need special authorization\n",
      "--------------------------------------------------------------------\n",
      "Livorno (Leghorn) (ITLIV)\n",
      "{'safmarine', 'Hapag', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " There are no unique Country Requirements / Restrictions for this port.You can always reach out to us directly in case of any further queries.\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " Material can enter temporarily without customs fees if it will be used to manufacture products for export. In this case, the importer gives a guarantee (from an insurance company or bank) for the amount of duties and taxes. This guarantee will be reimbursed when the final product is exported. This process also applies to goods planned to be re-exported.\n",
      "\n",
      "Prohibited\n",
      "\n",
      "• Meat and milk and any items thereof from non-EU countries with the exception of limited amounts from Andorra, Croatia, the Faeroe Islands, Greenland, Iceland and small amounts of specific products from other countries\n",
      "• Protected species and products thereof as listed by the CITES (Washington Convention) for example ivory, tortoise shell, coral, reptile skin, wood from Amazonian forests.\n",
      "\n",
      "\n",
      "Restricted\n",
      "\n",
      "• pets need to be identifiable (tattoo or an electronic identification system), vaccinated against rabies and have a health certificate. For more information please refer to the nearest embassy.\n",
      "• maximum of 10 kg of meat, milk and dairy products coming from Croatia, Færøer Islands, Greenland and Iceland\n",
      "• powdered milk for babies, food for children and special medical food (including pets food) may be allowed if they need not to be refrigerated prior opening and that it is brand packaged food and the packaging has original seal (unless in use at the time) and its quantity must not exceed the weight of 10 kg originating from Croatia, Færøer Islands, Greenland and Iceland, and of 2 kg if originating in other countries.\n",
      "• fish only if it is disembowelled and does not exceed the weight of 20 kg,\n",
      "• currency - no restrictions if coming from EU country. Declarable for all travelling outside EU when the amount exceeds 10.000 euro or equivalent in another currency.\n",
      "• coats, fur and leather shoes made of protected animals will need special authorization\n",
      "--------------------------------------------------------------------\n",
      "La Spezia (ITSPE)\n",
      "{'safmarine', 'Hapag', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " There are no unique Country Requirements / Restrictions for this port.You can always reach out to us directly in case of any further queries.\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " Material can enter temporarily without customs fees if it will be used to manufacture products for export. In this case, the importer gives a guarantee (from an insurance company or bank) for the amount of duties and taxes. This guarantee will be reimbursed when the final product is exported. This process also applies to goods planned to be re-exported.\n",
      "\n",
      "Prohibited\n",
      "\n",
      "• Meat and milk and any items thereof from non-EU countries with the exception of limited amounts from Andorra, Croatia, the Faeroe Islands, Greenland, Iceland and small amounts of specific products from other countries\n",
      "• Protected species and products thereof as listed by the CITES (Washington Convention) for example ivory, tortoise shell, coral, reptile skin, wood from Amazonian forests.\n",
      "\n",
      "Restricted\n",
      "\n",
      "• pets need to be identifiable (tattoo or an electronic identification system), vaccinated against rabies and have a health certificate. For more information please refer to the nearest embassy.\n",
      "• maximum of 10 kg of meat, milk and dairy products coming from Croatia, Færøer Islands, Greenland and Iceland\n",
      "• powdered milk for babies, food for children and special medical food (including pets food) may be allowed if they need not to be refrigerated prior opening and that it is brand packaged food and the packaging has original seal (unless in use at the time) and its quantity must not exceed the weight of 10 kg originating from Croatia, Færøer Islands, Greenland and Iceland, and of 2 kg if originating in other countries.\n",
      "• fish only if it is disembowelled and does not exceed the weight of 20 kg,\n",
      "• currency - no restrictions if coming from EU country. Declarable for all travelling outside EU when the amount exceeds 10.000 euro or equivalent in another currency.\n",
      "• coats, fur and leather shoes made of protected animals will need special authorization\n",
      "--------------------------------------------------------------------\n",
      "Gioia Tauro (ITGIT)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'safmarine', 'Hapag', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " There are no unique Country Requirements / Restrictions for this port.You can always reach out to us directly in case of any further queries.\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " Prohibited\n",
      "\n",
      "• Meat and milk and any items thereof from non-EU countries with the exception of limited amounts from Andorra, Croatia, the Faeroe Islands, Greenland, Iceland and small amounts of specific products from other countries\n",
      "• Protected species and products thereof as listed by the CITES (Washington Convention) for example ivory, tortoise shell, coral, reptile skin, wood from Amazonian forests.\n",
      "\n",
      "\"Restricted\n",
      "\n",
      "• pets need to be identifiable (tattoo or an electronic identification system), vaccinated against rabies and have a health certificate. For more information please refer to the nearest embassy.\n",
      "• maximum of 10 kg of meat, milk and dairy products coming from Croatia, Færøer Islands, Greenland and Iceland\n",
      "• powdered milk for babies, food for children and special medical food (including pets food) may be allowed if they need not to be refrigerated prior opening and that it is brand packaged food and the packaging has original seal (unless in use at the time) and its quantity must not exceed the weight of 10 kg originating from Croatia, Færøer Islands, Greenland and Iceland, and of 2 kg if originating in other countries.\n",
      "• fish only if it is disembowelled and does not exceed the weight of 20 kg,\n",
      "• currency - no restrictions if coming from EU country. Declarable for all travelling outside EU when the amount exceeds 10.000 euro or equivalent in another currency.\n",
      "• coats, fur and leather shoes made of protected animals will need special authorization\"\n",
      "--------------------------------------------------------------------\n",
      "Genoa (ITGOA)\n",
      "set()\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " There are no unique Country Requirements / Restrictions for this port.You can always reach out to us directly in case of any further queries.\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " Prohibited\n",
      "\n",
      "• Meat and milk and any items thereof from non-EU countries with the exception of limited amounts from Andorra, Croatia, the Faeroe Islands, Greenland, Iceland and small amounts of specific products from other countries\n",
      "• Protected species and products thereof as listed by the CITES (Washington Convention) for example ivory, tortoise shell, coral, reptile skin, wood from Amazonian forests.\n",
      "\n",
      "\"Restricted\n",
      "\n",
      "• pets need to be identifiable (tattoo or an electronic identification system), vaccinated against rabies and have a health certificate. For more information please refer to the nearest embassy.\n",
      "• maximum of 10 kg of meat, milk and dairy products coming from Croatia, Færøer Islands, Greenland and Iceland\n",
      "• powdered milk for babies, food for children and special medical food (including pets food) may be allowed if they need not to be refrigerated prior opening and that it is brand packaged food and the packaging has original seal (unless in use at the time) and its quantity must not exceed the weight of 10 kg originating from Croatia, Færøer Islands, Greenland and Iceland, and of 2 kg if originating in other countries.\n",
      "• fish only if it is disembowelled and does not exceed the weight of 20 kg,\n",
      "• currency - no restrictions if coming from EU country. Declarable for all travelling outside EU when the amount exceeds 10.000 euro or equivalent in another currency.\n",
      "• coats, fur and leather shoes made of protected animals will need special authorization\"\n",
      "--------------------------------------------------------------------\n",
      "Civitavecchia (ITCVV)\n",
      "{'safmarine', 'CMA'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " There are no unique Country Requirements / Restrictions for this port.You can always reach out to us directly in case of any further queries.\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " Prohibited\n",
      "\n",
      "• Meat and milk and any items thereof from non-EU countries with the exception of limited amounts from Andorra, Croatia, the Faeroe Islands, Greenland, Iceland and small amounts of specific products from other countries\n",
      "• Protected species and products thereof as listed by the CITES (Washington Convention) for example ivory, tortoise shell, coral, reptile skin, wood from Amazonian forests.\n",
      "\n",
      "\"Restricted\n",
      "\n",
      "• pets need to be identifiable (tattoo or an electronic identification system), vaccinated against rabies and have a health certificate. For more information please refer to the nearest embassy.\n",
      "• maximum of 10 kg of meat, milk and dairy products coming from Croatia, Færøer Islands, Greenland and Iceland\n",
      "• powdered milk for babies, food for children and special medical food (including pets food) may be allowed if they need not to be refrigerated prior opening and that it is brand packaged food and the packaging has original seal (unless in use at the time) and its quantity must not exceed the weight of 10 kg originating from Croatia, Færøer Islands, Greenland and Iceland, and of 2 kg if originating in other countries.\n",
      "• fish only if it is disembowelled and does not exceed the weight of 20 kg,\n",
      "• currency - no restrictions if coming from EU country. Declarable for all travelling outside EU when the amount exceeds 10.000 euro or equivalent in another currency.\n",
      "• coats, fur and leather shoes made of protected animals will need special authorization\"\n",
      "--------------------------------------------------------------------\n",
      "Catania (ITCTA)\n",
      "{'safmarine', 'CMA'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " There are no unique Country Requirements / Restrictions for this port.You can always reach out to us directly in case of any further queries.\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " Prohibited\n",
      "\n",
      "• Meat and milk and any items thereof from non-EU countries with the exception of limited amounts from Andorra, Croatia, the Faeroe Islands, Greenland, Iceland and small amounts of specific products from other countries\n",
      "• Protected species and products thereof as listed by the CITES (Washington Convention) for example ivory, tortoise shell, coral, reptile skin, wood from Amazonian forests.\n",
      "\n",
      "\"Restricted\n",
      "\n",
      "• pets need to be identifiable (tattoo or an electronic identification system), vaccinated against rabies and have a health certificate. For more information please refer to the nearest embassy.\n",
      "• maximum of 10 kg of meat, milk and dairy products coming from Croatia, Færøer Islands, Greenland and Iceland\n",
      "• powdered milk for babies, food for children and special medical food (including pets food) may be allowed if they need not to be refrigerated prior opening and that it is brand packaged food and the packaging has original seal (unless in use at the time) and its quantity must not exceed the weight of 10 kg originating from Croatia, Færøer Islands, Greenland and Iceland, and of 2 kg if originating in other countries.\n",
      "• fish only if it is disembowelled and does not exceed the weight of 20 kg,\n",
      "• currency - no restrictions if coming from EU country. Declarable for all travelling outside EU when the amount exceeds 10.000 euro or equivalent in another currency.\n",
      "• coats, fur and leather shoes made of protected animals will need special authorization\"\n",
      "--------------------------------------------------------------------\n",
      "Cagliari (ITCAG)\n",
      "{'safmarine', 'Hapag', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " There are no unique Country Requirements / Restrictions for this port.You can always reach out to us directly in case of any further queries.\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " Prohibited\n",
      "\n",
      "• Meat and milk and any items thereof from non-EU countries with the exception of limited amounts from Andorra, Croatia, the Faeroe Islands, Greenland, Iceland and small amounts of specific products from other countries\n",
      "• Protected species and products thereof as listed by the CITES (Washington Convention) for example ivory, tortoise shell, coral, reptile skin, wood from Amazonian forests.\n",
      "\n",
      "\"Restricted\n",
      "\n",
      "• pets need to be identifiable (tattoo or an electronic identification system), vaccinated against rabies and have a health certificate. For more information please refer to the nearest embassy.\n",
      "• maximum of 10 kg of meat, milk and dairy products coming from Croatia, Færøer Islands, Greenland and Iceland\n",
      "• powdered milk for babies, food for children and special medical food (including pets food) may be allowed if they need not to be refrigerated prior opening and that it is brand packaged food and the packaging has original seal (unless in use at the time) and its quantity must not exceed the weight of 10 kg originating from Croatia, Færøer Islands, Greenland and Iceland, and of 2 kg if originating in other countries.\n",
      "• fish only if it is disembowelled and does not exceed the weight of 20 kg,\n",
      "• currency - no restrictions if coming from EU country. Declarable for all travelling outside EU when the amount exceeds 10.000 euro or equivalent in another currency.\n",
      "• coats, fur and leather shoes made of protected animals will need special authorization\"\n",
      "--------------------------------------------------------------------\n",
      "Ancona(ITAOI)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'safmarine', 'Hapag', 'CMA', 'cosco'}\n",
      "--------------------------------------------------------------------\n",
      "Export restrictions\n",
      " There are no unique country requirements and restrictions for this port.You can reach out to us directly in case of any further queries.\n",
      "--------------------------------------------------------------------\n",
      "Import restrictions\n",
      " Prohibited\n",
      "\n",
      "• Meat and milk and any items thereof from non-EU countries with the exception of limited amounts from Andorra, Croatia, the Faeroe Islands, Greenland, Iceland and some specific products from other countries\n",
      "• Protected species and products thereof as listed by the CITES (Washington Convention) for example ivory, tortoise shell, coral, reptile skin and wood from Amazonian forests.\n",
      "\n",
      "Restricted\n",
      "\n",
      "• pets need to be identifiable (tattoo or an electronic identification system), vaccinated against rabies and have a health certificate. For more information you can refer to the nearest embassy.\n",
      "• maximum 10 kg of meat, milk and dairy products can come in from Croatia, Færøer Islands, Greenland and Iceland\n",
      "• powdered milk for babies, food for children and special medical food (including pet food) may be allowed if do not require refrigeration prior to opening. Or if it is branded packaged food and the packaging has original seal (unless in use at the time). Moreover its quantity must not exceed the weight of 10 kg originating from Croatia, Færøer Islands, Greenland and Iceland or 2 kg if  it is originating in other countries.\n",
      "• fish only if they are disembowelled and does not exceed the weight of 20 kg,\n",
      "• currency - no restrictions if it is coming from EU country. This is declarable for all travelling outside EU when the amount exceeds 10.000 euro or its equivalent in another currency.\n",
      "• coats, fur and leather shoes made of protected animals hides require special authorization\n",
      "--------------------------------------------------------------------\n"
     ]
    }
   ],
   "source": [
    "new_df = pd.DataFrame(columns=['iso', 'seaport', 'lines', 'import_restrictions', 'export_restrictions', 'website'])\n",
    "\n",
    "for code in countries:\n",
    "    \n",
    "    # Finding the country block using iso code\n",
    "    iso = soup.find_all(text=\"({})\".format(code))\n",
    "    \n",
    "    # Navigating to the country parent block\n",
    "    parent = iso[0].parent.parent.parent.parent\n",
    "    \n",
    "    # Retrieving all the seaports and websites mentioned in the block\n",
    "    ports = parent.find_all(\"p\")\n",
    "    websites = parent.find_all(\"a\")\n",
    "    main_table_contents = []\n",
    "    \n",
    "    # Iterating through each seaport individually\n",
    "    for port, website in zip(ports,websites):\n",
    "        print(port.string)\n",
    "        \n",
    "        # Clicking on each seaport mentioned in the country block using websites mentioned\n",
    "        seaport = requests.get(main_url + website.get(\"href\")).text\n",
    "        doc = BeautifulSoup(seaport, \"html.parser\")\n",
    "        \n",
    "        # Finding the tables with lines mentioned\n",
    "        tables = doc.find_all('table')\n",
    "        main_table_contents = []\n",
    "        table_contents = []\n",
    "        \n",
    "        # Collating all values in the table\n",
    "        for table in tables:\n",
    "            rows = table.find_all('td')\n",
    "            for row in rows:\n",
    "                table_contents.append([row.text])\n",
    "        \n",
    "        main_table_contents.append([table_contents])\n",
    "        s = []\n",
    "        \n",
    "        # Filtering out only the lines values\n",
    "        for i in range(np.shape(main_table_contents)[0]):\n",
    "            for j in range(0,np.shape(main_table_contents[i][0])[0],5):\n",
    "                s.append(main_table_contents[i][0][j][0])\n",
    "        \n",
    "        print(set(s))\n",
    "        \n",
    "        # Finding the block which has information about Import restrictions\n",
    "        import_restrictions = doc.find('div', {'class':\"styles_info__gszri\"})\n",
    "        \n",
    "        # Finding the block which has information about Export restrictions        \n",
    "        export_restrictions = doc.find('div', {'class':\"styles_info__SMa4k\"})\n",
    "        print(\"--------------------------------------------------------------------\")\n",
    "        print(\"Export restrictions\\n\",export_restrictions.get_text())\n",
    "        print(\"--------------------------------------------------------------------\")\n",
    "        print(\"Import restrictions\\n\",import_restrictions.get_text())\n",
    "        print(\"--------------------------------------------------------------------\")\n",
    "        \n",
    "        \n",
    "        # Adding values to the new dataframe based on the values retrieved from the website\n",
    "        new_df = new_df.append({'iso' : code, 'seaport' : port.string, 'lines' : \", \".join(str(e) for e in set(s)), 'import_restrictions':import_restrictions.get_text(),'export_restrictions':export_restrictions.get_text(),'website':main_url + website.get(\"href\")}, ignore_index = True)\n",
    "        \n",
    "        "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f86ee6b6",
   "metadata": {},
   "source": [
    "## Goal 2\n",
    "\n",
    "### Table below display all the seaports within the countries mentioned in trades.csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "05da9788",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>iso</th>\n",
       "      <th>seaport</th>\n",
       "      <th>lines</th>\n",
       "      <th>import_restrictions</th>\n",
       "      <th>export_restrictions</th>\n",
       "      <th>website</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>BE</td>\n",
       "      <td>Antwerp (BEANR)</td>\n",
       "      <td>safmarine, Hapag, CMA, cosco</td>\n",
       "      <td>Prohibited\\n\\n• Meat and milk and any items th...</td>\n",
       "      <td>There are no unique country requirements or re...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>DE</td>\n",
       "      <td>Mannheim (DEMHG)</td>\n",
       "      <td>safmarine, Hapag, CMA, cosco</td>\n",
       "      <td>\\nThe import of unauthorised fireworks into Ge...</td>\n",
       "      <td>Exporters are required to fill out a DEB (decl...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>DE</td>\n",
       "      <td>Hamburg (DEHAM)</td>\n",
       "      <td>safmarine, Hapag, CMA, cosco</td>\n",
       "      <td>\\nThe import of unauthorised fireworks into Ge...</td>\n",
       "      <td>Commodity No restrictions\\nWeight limits for r...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>DE</td>\n",
       "      <td>Bremerhaven (DEBRV)</td>\n",
       "      <td>maersk, cosco, safmarine, Hapag, CMA</td>\n",
       "      <td>\\nThe import of unauthorised fireworks into Ge...</td>\n",
       "      <td>Commodity : No restrictions\\nWeight limits for...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>DE</td>\n",
       "      <td>Bremen (DEBRE)</td>\n",
       "      <td>maersk, cosco, safmarine, Hapag, CMA</td>\n",
       "      <td>\\nThe import of unauthorised fireworks into Ge...</td>\n",
       "      <td>Commodity No restrictions\\nWeight limits for r...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>JO</td>\n",
       "      <td>Amman</td>\n",
       "      <td>safmarine, Hapag, CMA, cosco</td>\n",
       "      <td>There are no unique Country Requirements / Res...</td>\n",
       "      <td>For changing Weight - \\n1. Amendment request l...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>JO</td>\n",
       "      <td>Aqaba (JOAQJ)</td>\n",
       "      <td>safmarine, CMA, cosco</td>\n",
       "      <td>There are no unique country requirements or re...</td>\n",
       "      <td>Process for changing weight - \\n1. Amendment r...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>AE</td>\n",
       "      <td>Hulaylah</td>\n",
       "      <td>safmarine, maersk, CMA, cosco</td>\n",
       "      <td>The consignee/agent should obtain a delivery o...</td>\n",
       "      <td>Any cargo rejected by local authorities (custo...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>AE</td>\n",
       "      <td>Khalifa</td>\n",
       "      <td>safmarine, maersk, CMA, cosco</td>\n",
       "      <td>The consignee/agent should obtain a delivery o...</td>\n",
       "      <td>Any cargo rejected by local authorities (custo...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>AE</td>\n",
       "      <td>Ruwais</td>\n",
       "      <td>safmarine, maersk, CMA, cosco</td>\n",
       "      <td>The consignee/agent should obtain a delivery o...</td>\n",
       "      <td>Any cargo rejected by local authorities (custo...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>AE</td>\n",
       "      <td>Fujairah (AEFJR)</td>\n",
       "      <td>safmarine, maersk, CMA, cosco</td>\n",
       "      <td>The consignee/agent should obtain a delivery o...</td>\n",
       "      <td>Any cargo rejected by local authorities (custo...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>AE</td>\n",
       "      <td>Ajman</td>\n",
       "      <td>safmarine, maersk, CMA, cosco</td>\n",
       "      <td>The consignee/agent should obtain a delivery o...</td>\n",
       "      <td>Any cargo rejected by local authorities (custo...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>AE</td>\n",
       "      <td>Sharjah (KHALID) (AESHJ)</td>\n",
       "      <td>safmarine, maersk, CMA, cosco</td>\n",
       "      <td>The consignee/agent should obtain a delivery o...</td>\n",
       "      <td>Any cargo rejected by local authorities (custo...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>AE</td>\n",
       "      <td>Khor Fakkan (AEKLF)</td>\n",
       "      <td>safmarine, maersk, CMA, cosco</td>\n",
       "      <td>\"The consignee/agent should obtain a delivery ...</td>\n",
       "      <td>Any cargo rejected by local authorities (custo...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>AE</td>\n",
       "      <td>Jebel Ali (AEJEA)</td>\n",
       "      <td>safmarine, maersk, CMA, cosco</td>\n",
       "      <td>The consignee/agent should obtain a delivery o...</td>\n",
       "      <td>Any cargo rejected by local authorities (custo...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>AE</td>\n",
       "      <td>Abu Dhabi</td>\n",
       "      <td>maersk, cosco, safmarine, Hapag, CMA</td>\n",
       "      <td>The consignee/agent must obtain a delivery ord...</td>\n",
       "      <td>In case any cargo is rejected by local authori...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>IT</td>\n",
       "      <td>Venice (Venezia) (ITVCE)</td>\n",
       "      <td>safmarine, Hapag, CMA, cosco</td>\n",
       "      <td>Prohibited\\n\\n• Meat and milk and any items th...</td>\n",
       "      <td>There are no unique Country Requirements / Res...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>IT</td>\n",
       "      <td>Trieste (ITTRS)</td>\n",
       "      <td>safmarine, Hapag, CMA, cosco</td>\n",
       "      <td>Prohibited\\n\\n• Meat and milk and any items th...</td>\n",
       "      <td>There are no unique Country Requirements / Res...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>IT</td>\n",
       "      <td>Salerno (ITSAL)</td>\n",
       "      <td>safmarine, Hapag, CMA, cosco</td>\n",
       "      <td>Prohibited\\n\\n• Meat and milk and any items th...</td>\n",
       "      <td>There are no unique Country Requirements / Res...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>IT</td>\n",
       "      <td>Napoli</td>\n",
       "      <td>safmarine, Hapag, CMA, cosco</td>\n",
       "      <td>Material can enter temporarily without customs...</td>\n",
       "      <td>There are no unique Country Requirements / Res...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>IT</td>\n",
       "      <td>Livorno (Leghorn) (ITLIV)</td>\n",
       "      <td>safmarine, Hapag, CMA, cosco</td>\n",
       "      <td>Material can enter temporarily without customs...</td>\n",
       "      <td>There are no unique Country Requirements / Res...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>IT</td>\n",
       "      <td>La Spezia (ITSPE)</td>\n",
       "      <td>safmarine, Hapag, CMA, cosco</td>\n",
       "      <td>Material can enter temporarily without customs...</td>\n",
       "      <td>There are no unique Country Requirements / Res...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>IT</td>\n",
       "      <td>Gioia Tauro (ITGIT)</td>\n",
       "      <td>safmarine, Hapag, CMA, cosco</td>\n",
       "      <td>Prohibited\\n\\n• Meat and milk and any items th...</td>\n",
       "      <td>There are no unique Country Requirements / Res...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>IT</td>\n",
       "      <td>Genoa (ITGOA)</td>\n",
       "      <td></td>\n",
       "      <td>Prohibited\\n\\n• Meat and milk and any items th...</td>\n",
       "      <td>There are no unique Country Requirements / Res...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>IT</td>\n",
       "      <td>Civitavecchia (ITCVV)</td>\n",
       "      <td>safmarine, CMA</td>\n",
       "      <td>Prohibited\\n\\n• Meat and milk and any items th...</td>\n",
       "      <td>There are no unique Country Requirements / Res...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>IT</td>\n",
       "      <td>Catania (ITCTA)</td>\n",
       "      <td>safmarine, CMA</td>\n",
       "      <td>Prohibited\\n\\n• Meat and milk and any items th...</td>\n",
       "      <td>There are no unique Country Requirements / Res...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>IT</td>\n",
       "      <td>Cagliari (ITCAG)</td>\n",
       "      <td>safmarine, Hapag, CMA, cosco</td>\n",
       "      <td>Prohibited\\n\\n• Meat and milk and any items th...</td>\n",
       "      <td>There are no unique Country Requirements / Res...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>IT</td>\n",
       "      <td>Ancona(ITAOI)</td>\n",
       "      <td>safmarine, Hapag, CMA, cosco</td>\n",
       "      <td>Prohibited\\n\\n• Meat and milk and any items th...</td>\n",
       "      <td>There are no unique country requirements and r...</td>\n",
       "      <td>https://www.cogoport.com/en-IN/knowledge-cente...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   iso                    seaport                                 lines  \\\n",
       "0   BE            Antwerp (BEANR)          safmarine, Hapag, CMA, cosco   \n",
       "1   DE           Mannheim (DEMHG)          safmarine, Hapag, CMA, cosco   \n",
       "2   DE            Hamburg (DEHAM)          safmarine, Hapag, CMA, cosco   \n",
       "3   DE        Bremerhaven (DEBRV)  maersk, cosco, safmarine, Hapag, CMA   \n",
       "4   DE             Bremen (DEBRE)  maersk, cosco, safmarine, Hapag, CMA   \n",
       "5   JO                      Amman          safmarine, Hapag, CMA, cosco   \n",
       "6   JO              Aqaba (JOAQJ)                 safmarine, CMA, cosco   \n",
       "7   AE                   Hulaylah         safmarine, maersk, CMA, cosco   \n",
       "8   AE                    Khalifa         safmarine, maersk, CMA, cosco   \n",
       "9   AE                     Ruwais         safmarine, maersk, CMA, cosco   \n",
       "10  AE           Fujairah (AEFJR)         safmarine, maersk, CMA, cosco   \n",
       "11  AE                      Ajman         safmarine, maersk, CMA, cosco   \n",
       "12  AE   Sharjah (KHALID) (AESHJ)         safmarine, maersk, CMA, cosco   \n",
       "13  AE        Khor Fakkan (AEKLF)         safmarine, maersk, CMA, cosco   \n",
       "14  AE          Jebel Ali (AEJEA)         safmarine, maersk, CMA, cosco   \n",
       "15  AE                  Abu Dhabi  maersk, cosco, safmarine, Hapag, CMA   \n",
       "16  IT   Venice (Venezia) (ITVCE)          safmarine, Hapag, CMA, cosco   \n",
       "17  IT            Trieste (ITTRS)          safmarine, Hapag, CMA, cosco   \n",
       "18  IT            Salerno (ITSAL)          safmarine, Hapag, CMA, cosco   \n",
       "19  IT                     Napoli          safmarine, Hapag, CMA, cosco   \n",
       "20  IT  Livorno (Leghorn) (ITLIV)          safmarine, Hapag, CMA, cosco   \n",
       "21  IT          La Spezia (ITSPE)          safmarine, Hapag, CMA, cosco   \n",
       "22  IT        Gioia Tauro (ITGIT)          safmarine, Hapag, CMA, cosco   \n",
       "23  IT              Genoa (ITGOA)                                         \n",
       "24  IT      Civitavecchia (ITCVV)                        safmarine, CMA   \n",
       "25  IT            Catania (ITCTA)                        safmarine, CMA   \n",
       "26  IT           Cagliari (ITCAG)          safmarine, Hapag, CMA, cosco   \n",
       "27  IT              Ancona(ITAOI)          safmarine, Hapag, CMA, cosco   \n",
       "\n",
       "                                  import_restrictions  \\\n",
       "0   Prohibited\\n\\n• Meat and milk and any items th...   \n",
       "1   \\nThe import of unauthorised fireworks into Ge...   \n",
       "2   \\nThe import of unauthorised fireworks into Ge...   \n",
       "3   \\nThe import of unauthorised fireworks into Ge...   \n",
       "4   \\nThe import of unauthorised fireworks into Ge...   \n",
       "5   There are no unique Country Requirements / Res...   \n",
       "6   There are no unique country requirements or re...   \n",
       "7   The consignee/agent should obtain a delivery o...   \n",
       "8   The consignee/agent should obtain a delivery o...   \n",
       "9   The consignee/agent should obtain a delivery o...   \n",
       "10  The consignee/agent should obtain a delivery o...   \n",
       "11  The consignee/agent should obtain a delivery o...   \n",
       "12  The consignee/agent should obtain a delivery o...   \n",
       "13  \"The consignee/agent should obtain a delivery ...   \n",
       "14  The consignee/agent should obtain a delivery o...   \n",
       "15  The consignee/agent must obtain a delivery ord...   \n",
       "16  Prohibited\\n\\n• Meat and milk and any items th...   \n",
       "17  Prohibited\\n\\n• Meat and milk and any items th...   \n",
       "18  Prohibited\\n\\n• Meat and milk and any items th...   \n",
       "19  Material can enter temporarily without customs...   \n",
       "20  Material can enter temporarily without customs...   \n",
       "21  Material can enter temporarily without customs...   \n",
       "22  Prohibited\\n\\n• Meat and milk and any items th...   \n",
       "23  Prohibited\\n\\n• Meat and milk and any items th...   \n",
       "24  Prohibited\\n\\n• Meat and milk and any items th...   \n",
       "25  Prohibited\\n\\n• Meat and milk and any items th...   \n",
       "26  Prohibited\\n\\n• Meat and milk and any items th...   \n",
       "27  Prohibited\\n\\n• Meat and milk and any items th...   \n",
       "\n",
       "                                  export_restrictions  \\\n",
       "0   There are no unique country requirements or re...   \n",
       "1   Exporters are required to fill out a DEB (decl...   \n",
       "2   Commodity No restrictions\\nWeight limits for r...   \n",
       "3   Commodity : No restrictions\\nWeight limits for...   \n",
       "4   Commodity No restrictions\\nWeight limits for r...   \n",
       "5   For changing Weight - \\n1. Amendment request l...   \n",
       "6   Process for changing weight - \\n1. Amendment r...   \n",
       "7   Any cargo rejected by local authorities (custo...   \n",
       "8   Any cargo rejected by local authorities (custo...   \n",
       "9   Any cargo rejected by local authorities (custo...   \n",
       "10  Any cargo rejected by local authorities (custo...   \n",
       "11  Any cargo rejected by local authorities (custo...   \n",
       "12  Any cargo rejected by local authorities (custo...   \n",
       "13  Any cargo rejected by local authorities (custo...   \n",
       "14  Any cargo rejected by local authorities (custo...   \n",
       "15  In case any cargo is rejected by local authori...   \n",
       "16  There are no unique Country Requirements / Res...   \n",
       "17  There are no unique Country Requirements / Res...   \n",
       "18  There are no unique Country Requirements / Res...   \n",
       "19  There are no unique Country Requirements / Res...   \n",
       "20  There are no unique Country Requirements / Res...   \n",
       "21  There are no unique Country Requirements / Res...   \n",
       "22  There are no unique Country Requirements / Res...   \n",
       "23  There are no unique Country Requirements / Res...   \n",
       "24  There are no unique Country Requirements / Res...   \n",
       "25  There are no unique Country Requirements / Res...   \n",
       "26  There are no unique Country Requirements / Res...   \n",
       "27  There are no unique country requirements and r...   \n",
       "\n",
       "                                              website  \n",
       "0   https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "1   https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "2   https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "3   https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "4   https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "5   https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "6   https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "7   https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "8   https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "9   https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "10  https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "11  https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "12  https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "13  https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "14  https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "15  https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "16  https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "17  https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "18  https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "19  https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "20  https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "21  https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "22  https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "23  https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "24  https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "25  https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "26  https://www.cogoport.com/en-IN/knowledge-cente...  \n",
       "27  https://www.cogoport.com/en-IN/knowledge-cente...  "
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f18dfc9f",
   "metadata": {},
   "source": [
    "# 3. Loading the data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "74ba4f06",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_df.to_csv('ports_info.csv',index=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "53462378",
   "metadata": {},
   "source": [
    "### Data would be available for querying as a PostgreSQL table from other teams"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "ef591e7a",
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Table 'ports_info' already exists.",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Input \u001b[0;32mIn [14]\u001b[0m, in \u001b[0;36m<cell line: 3>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01msqlalchemy\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m create_engine\n\u001b[1;32m      2\u001b[0m engine \u001b[38;5;241m=\u001b[39m create_engine(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mpostgresql://postgres:password@localhost:5432/postgres\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[0;32m----> 3\u001b[0m \u001b[43mnew_df\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mto_sql\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mports_info\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mengine\u001b[49m\u001b[43m,\u001b[49m\u001b[43mindex\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43;01mFalse\u001b[39;49;00m\u001b[43m)\u001b[49m\n",
      "File \u001b[0;32m/opt/anaconda3/lib/python3.8/site-packages/pandas/core/generic.py:2872\u001b[0m, in \u001b[0;36mNDFrame.to_sql\u001b[0;34m(self, name, con, schema, if_exists, index, index_label, chunksize, dtype, method)\u001b[0m\n\u001b[1;32m   2734\u001b[0m \u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[1;32m   2735\u001b[0m \u001b[38;5;124;03mWrite records stored in a DataFrame to a SQL database.\u001b[39;00m\n\u001b[1;32m   2736\u001b[0m \n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m   2868\u001b[0m \u001b[38;5;124;03m[(1,), (None,), (2,)]\u001b[39;00m\n\u001b[1;32m   2869\u001b[0m \u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[1;32m   2870\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mpandas\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mio\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m sql\n\u001b[0;32m-> 2872\u001b[0m \u001b[43msql\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mto_sql\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m   2873\u001b[0m \u001b[43m    \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[1;32m   2874\u001b[0m \u001b[43m    \u001b[49m\u001b[43mname\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   2875\u001b[0m \u001b[43m    \u001b[49m\u001b[43mcon\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   2876\u001b[0m \u001b[43m    \u001b[49m\u001b[43mschema\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mschema\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   2877\u001b[0m \u001b[43m    \u001b[49m\u001b[43mif_exists\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mif_exists\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   2878\u001b[0m \u001b[43m    \u001b[49m\u001b[43mindex\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mindex\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   2879\u001b[0m \u001b[43m    \u001b[49m\u001b[43mindex_label\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mindex_label\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   2880\u001b[0m \u001b[43m    \u001b[49m\u001b[43mchunksize\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mchunksize\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   2881\u001b[0m \u001b[43m    \u001b[49m\u001b[43mdtype\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mdtype\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   2882\u001b[0m \u001b[43m    \u001b[49m\u001b[43mmethod\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mmethod\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   2883\u001b[0m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[0;32m/opt/anaconda3/lib/python3.8/site-packages/pandas/io/sql.py:717\u001b[0m, in \u001b[0;36mto_sql\u001b[0;34m(frame, name, con, schema, if_exists, index, index_label, chunksize, dtype, method, engine, **engine_kwargs)\u001b[0m\n\u001b[1;32m    712\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(frame, DataFrame):\n\u001b[1;32m    713\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mNotImplementedError\u001b[39;00m(\n\u001b[1;32m    714\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mframe\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m argument should be either a Series or a DataFrame\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m    715\u001b[0m     )\n\u001b[0;32m--> 717\u001b[0m \u001b[43mpandas_sql\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mto_sql\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m    718\u001b[0m \u001b[43m    \u001b[49m\u001b[43mframe\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    719\u001b[0m \u001b[43m    \u001b[49m\u001b[43mname\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    720\u001b[0m \u001b[43m    \u001b[49m\u001b[43mif_exists\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mif_exists\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    721\u001b[0m \u001b[43m    \u001b[49m\u001b[43mindex\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mindex\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    722\u001b[0m \u001b[43m    \u001b[49m\u001b[43mindex_label\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mindex_label\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    723\u001b[0m \u001b[43m    \u001b[49m\u001b[43mschema\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mschema\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    724\u001b[0m \u001b[43m    \u001b[49m\u001b[43mchunksize\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mchunksize\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    725\u001b[0m \u001b[43m    \u001b[49m\u001b[43mdtype\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mdtype\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    726\u001b[0m \u001b[43m    \u001b[49m\u001b[43mmethod\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mmethod\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    727\u001b[0m \u001b[43m    \u001b[49m\u001b[43mengine\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mengine\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    728\u001b[0m \u001b[43m    \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mengine_kwargs\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    729\u001b[0m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[0;32m/opt/anaconda3/lib/python3.8/site-packages/pandas/io/sql.py:1751\u001b[0m, in \u001b[0;36mSQLDatabase.to_sql\u001b[0;34m(self, frame, name, if_exists, index, index_label, schema, chunksize, dtype, method, engine, **engine_kwargs)\u001b[0m\n\u001b[1;32m   1701\u001b[0m \u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[1;32m   1702\u001b[0m \u001b[38;5;124;03mWrite records stored in a DataFrame to a SQL database.\u001b[39;00m\n\u001b[1;32m   1703\u001b[0m \n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m   1747\u001b[0m \u001b[38;5;124;03m    Any additional kwargs are passed to the engine.\u001b[39;00m\n\u001b[1;32m   1748\u001b[0m \u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[1;32m   1749\u001b[0m sql_engine \u001b[38;5;241m=\u001b[39m get_engine(engine)\n\u001b[0;32m-> 1751\u001b[0m table \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mprep_table\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m   1752\u001b[0m \u001b[43m    \u001b[49m\u001b[43mframe\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mframe\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   1753\u001b[0m \u001b[43m    \u001b[49m\u001b[43mname\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mname\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   1754\u001b[0m \u001b[43m    \u001b[49m\u001b[43mif_exists\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mif_exists\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   1755\u001b[0m \u001b[43m    \u001b[49m\u001b[43mindex\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mindex\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   1756\u001b[0m \u001b[43m    \u001b[49m\u001b[43mindex_label\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mindex_label\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   1757\u001b[0m \u001b[43m    \u001b[49m\u001b[43mschema\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mschema\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   1758\u001b[0m \u001b[43m    \u001b[49m\u001b[43mdtype\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mdtype\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m   1759\u001b[0m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m   1761\u001b[0m sql_engine\u001b[38;5;241m.\u001b[39minsert_records(\n\u001b[1;32m   1762\u001b[0m     table\u001b[38;5;241m=\u001b[39mtable,\n\u001b[1;32m   1763\u001b[0m     con\u001b[38;5;241m=\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mconnectable,\n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m   1770\u001b[0m     \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mengine_kwargs,\n\u001b[1;32m   1771\u001b[0m )\n\u001b[1;32m   1773\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcheck_case_sensitive(name\u001b[38;5;241m=\u001b[39mname, schema\u001b[38;5;241m=\u001b[39mschema)\n",
      "File \u001b[0;32m/opt/anaconda3/lib/python3.8/site-packages/pandas/io/sql.py:1650\u001b[0m, in \u001b[0;36mSQLDatabase.prep_table\u001b[0;34m(self, frame, name, if_exists, index, index_label, schema, dtype)\u001b[0m\n\u001b[1;32m   1638\u001b[0m             \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mThe type of \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mcol\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m is not a SQLAlchemy type\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m   1640\u001b[0m table \u001b[38;5;241m=\u001b[39m SQLTable(\n\u001b[1;32m   1641\u001b[0m     name,\n\u001b[1;32m   1642\u001b[0m     \u001b[38;5;28mself\u001b[39m,\n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m   1648\u001b[0m     dtype\u001b[38;5;241m=\u001b[39mdtype,\n\u001b[1;32m   1649\u001b[0m )\n\u001b[0;32m-> 1650\u001b[0m \u001b[43mtable\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcreate\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m   1651\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m table\n",
      "File \u001b[0;32m/opt/anaconda3/lib/python3.8/site-packages/pandas/io/sql.py:858\u001b[0m, in \u001b[0;36mSQLTable.create\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    856\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mexists():\n\u001b[1;32m    857\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mif_exists \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mfail\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n\u001b[0;32m--> 858\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mTable \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mname\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m already exists.\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m    859\u001b[0m     \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mif_exists \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mreplace\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n\u001b[1;32m    860\u001b[0m         \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mpd_sql\u001b[38;5;241m.\u001b[39mdrop_table(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mname, \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mschema)\n",
      "\u001b[0;31mValueError\u001b[0m: Table 'ports_info' already exists."
     ]
    }
   ],
   "source": [
    "from sqlalchemy import create_engine\n",
    "engine = create_engine('postgresql://postgres:password@localhost:5432/postgres')\n",
    "new_df.to_sql('ports_info', engine,index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d378c99e",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
